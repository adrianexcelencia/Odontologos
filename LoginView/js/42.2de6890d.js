"use strict";(self["webpackChunkprueba"]=self["webpackChunkprueba"]||[]).push([[42],{4271:function(s,a,r){r.d(a,{Z:function(){return u}});var e=r(3396),o=r(7139);const i={key:0,class:"alert alert-danger d-flex align-items-center",role:"alert"},t=(0,e._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x-circle-fill",viewBox:"0 0 16 16"},[(0,e._)("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"})],-1);function l(s,a,r,l,n,c){return r.visible?((0,e.wg)(),(0,e.iD)("div",i,[(0,e._)("div",null,[t,(0,e.Uk)(" "+(0,o.zw)(r.mensaje),1)])])):(0,e.kq)("",!0)}var n={props:{visible:Boolean,mensaje:String}},c=r(89);const d=(0,c.Z)(n,[["render",l]]);var u=d},1042:function(s,a,r){r.r(a),r.d(a,{default:function(){return Ds}});var e=r(3396),o=r(7139);const i={key:3},t={class:"p-3 text-sm",style:{"max-width":"1300px"}},l=(0,e._)("b",null," Lista de usuarios ",-1),n={class:"row p-3",style:{"max-width":"1300px"}},c={class:"col"},d=(0,e._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-plus-square-fill",viewBox:"0 0 16 16"},[(0,e._)("path",{d:"M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm6.5 4.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3a.5.5 0 0 1 1 0z"})],-1),u={class:"container-sm",style:{"max-width":"1300px"}},m={class:"table-container"},h={key:0,class:"table align-middle mx-auto"},p=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",{scope:"col"},"Nombre de usuario"),(0,e._)("th",{scope:"col"}),(0,e._)("th",{scope:"col"},"Permisos"),(0,e._)("th",{scope:"col",class:"nowrap"},"Acciones")])],-1),v={key:0,disabled:"",class:"btn btn-outline-success btn-sm ms-3"},g=["onClick"],b=(0,e._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-eye-fill",viewBox:"0 0 16 16"},[(0,e._)("path",{d:"M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"}),(0,e._)("path",{d:"M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"})],-1),w={class:"nowrap"},f={class:"row"},_={class:"col-auto"},k=["onClick"],y=(0,e._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-pencil-fill",viewBox:"0 0 16 16"},[(0,e._)("path",{d:"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z"})],-1),x={class:"col-auto"},E=["onClick"],C=(0,e._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash-fill",viewBox:"0 0 16 16"},[(0,e._)("path",{d:"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"})],-1),U={key:0,class:"alert alert-primary d-flex align-items-center",role:"alert"},D=(0,e._)("svg",{class:"bi flex-shrink-0 me-2",width:"24",height:"24",role:"img","aria-label":"Info:"},[(0,e._)("use",{"xlink:href":"#info-fill"})],-1),M=(0,e._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-exclamation-triangle-fill",viewBox:"0 0 16 16"},[(0,e._)("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"})],-1),A=(0,e._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x-square-fill",viewBox:"0 0 16 16"},[(0,e._)("path",{d:"M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708z"})],-1);function S(s,a,r,S,P,I){const z=(0,e.up)("ver-permisos"),L=(0,e.up)("editar-usuario"),V=(0,e.up)("barra-navegacion"),j=(0,e.up)("spinner"),q=(0,e.up)("v-chip"),H=(0,e.up)("router-link"),$=(0,e.up)("alerta-suceso"),N=(0,e.up)("alerta-error");return(0,e.wg)(),(0,e.iD)(e.HY,null,[s.modalVerpermisos?((0,e.wg)(),(0,e.j4)(z,{key:0,"usuario-id":s.DatosUsuario.userID,onCerrarModalPermisos:I.cerrarModalVerPermisos},null,8,["usuario-id","onCerrarModalPermisos"])):(0,e.kq)("",!0),s.modalEditarUsuario?((0,e.wg)(),(0,e.j4)(L,{key:1,"usuario-id":s.DatosUsuario.userID,onCerrarModalEditar:I.cerrarModalEdicion,onGuardarExito:I.editarListo},null,8,["usuario-id","onCerrarModalEditar","onGuardarExito"])):(0,e.kq)("",!0),s.modalVerpermisos?((0,e.wg)(),(0,e.iD)("div",{key:2,onClick:a[0]||(a[0]=(...s)=>I.cerrarModalVerPermisos&&I.cerrarModalVerPermisos(...s)),class:"modal-overlay"})):(0,e.kq)("",!0),(0,e.Wm)(V),(0,e.Wm)(j,{visible:s.MostrarSpinner},null,8,["visible"]),s.MostrarSpinner?(0,e.kq)("",!0):((0,e.wg)(),(0,e.iD)("div",i,[(0,e._)("div",t,[(0,e.Wm)(q,{class:"d-flex darken-1 sm",color:"#000000",elevation:"1",style:{"z-index":"-1"}},{default:(0,e.w5)((()=>[l])),_:1})]),(0,e._)("div",n,[(0,e._)("div",c,[s.$store.state.permisos.includes(1)?((0,e.wg)(),(0,e.j4)(H,{key:0,to:"/crearusuario",class:"btn btn-outline-primary btn-sm custom-margin-botonN"},{default:(0,e.w5)((()=>[d,(0,e.Uk)(" Nuevo")])),_:1})):(0,e.kq)("",!0)])]),(0,e._)("div",u,[(0,e._)("div",m,[s.$store.state.permisos.includes(2)?((0,e.wg)(),(0,e.iD)("table",h,[p,((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.ListaUsuarios,(r=>((0,e.wg)(),(0,e.iD)("tbody",{key:r.usuarioId},[(0,e._)("tr",{style:(0,o.j5)({"pointer-events":"0"===s.$store.state.rol?"none":"auto"})},[(0,e._)("td",null,(0,o.zw)(r.username),1),(0,e._)("td",null,[1===r.roleID?((0,e.wg)(),(0,e.iD)("button",v,"Administrador")):(0,e.kq)("",!0)]),(0,e._)("td",null,[(0,e._)("div",null,[s.$store.state.permisos.includes(5)?((0,e.wg)(),(0,e.iD)("button",{key:0,class:"btn btn-outline-info btn-sm ms-3",title:"Permisos",onClick:s=>I.verPermisos(r)},[b,(0,e.Uk)(" Ver Permisos")],8,g)):(0,e.kq)("",!0)])]),(0,e._)("td",w,[(0,e._)("div",f,[(0,e._)("div",_,[s.$store.state.permisos.includes(2)?((0,e.wg)(),(0,e.iD)("button",{key:0,class:"btn btn-outline-warning btn-sm ms-3",title:"Editar",onClick:[a[1]||(a[1]=(...a)=>s.asd&&s.asd(...a)),s=>I.mostrarModalEdicion(r)]},[y,(0,e.Uk)(" Editar")],8,k)):(0,e.kq)("",!0)]),(0,e._)("div",x,[s.$store.state.permisos.includes(5)?((0,e.wg)(),(0,e.iD)("button",{key:0,class:"btn btn-outline-danger btn-sm ms-3",title:"Eliminar",onClick:s=>I.mostarAlertaConfirmacion(r)},[C,(0,e.Uk)(" Eliminar")],8,E)):(0,e.kq)("",!0)])])])],4)])))),128))])):(0,e.kq)("",!0)]),s.mostrarAlertaEliminar?((0,e.wg)(),(0,e.iD)("div",U,[D,(0,e._)("div",null,[(0,e.Uk)(" ¿Estás seguro de que deseas eliminar este registro? "),(0,e._)("button",{class:"btn btn-outline-danger btn-sm ms-3",onClick:a[2]||(a[2]=a=>I.eliminarUsuario(s.idUserToDelete))},[M,(0,e.Uk)(" Confirmar")]),(0,e._)("button",{class:"btn btn-outline-secondary btn-sm ms-2",onClick:a[3]||(a[3]=(...s)=>I.cerrarAlertaConfirmacion&&I.cerrarAlertaConfirmacion(...s))},[A,(0,e.Uk)(" Cancelar")])])])):(0,e.kq)("",!0),(0,e.Wm)($,{visible:s.mostrarAlertaSuceso,mensaje:s.mensajeAlertaSuceso},null,8,["visible","mensaje"]),(0,e.Wm)(N,{visible:s.mostrarAlertaError,mensaje:s.mensajeAlertaError},null,8,["visible","mensaje"])])]))],64)}const P=s=>((0,e.dD)("data-v-6de39afd"),s=s(),(0,e.Cn)(),s),I={class:"modal-permisos"},z={class:"modal-contenido"},L={class:"modal-content"},V={class:"modal-header"},j=P((()=>(0,e._)("label",{class:"text-muted fs-7"},"Permisos",-1))),q={class:"modal-body text-center"},H={key:0,class:"text-muted fs-8"},$={key:1,class:"d-flex justify-content-center"},N=P((()=>(0,e._)("div",{class:"spinner-border",role:"status"},[(0,e._)("span",{class:"sr-only"})],-1))),T=[N],Z={key:2},B={class:"list-group-item list-group-item-info fs-7"};function W(s,a,r,i,t,l){return(0,e.wg)(),(0,e.iD)("div",I,[(0,e._)("div",z,[(0,e._)("div",L,[(0,e._)("div",V,[j,(0,e._)("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=(...s)=>l.cerrarModalPermisos&&l.cerrarModalPermisos(...s)),"aria-label":"Cerrar"})]),(0,e._)("div",q,[t.mensajeNoHayPermisos?((0,e.wg)(),(0,e.iD)("span",H," No tiene permisos asignados ")):(0,e.kq)("",!0),t.loading?((0,e.wg)(),(0,e.iD)("div",$,T)):(0,e.kq)("",!0),t.loading?(0,e.kq)("",!0):((0,e.wg)(),(0,e.iD)("div",Z,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(t.ListaPermisos,(s=>((0,e.wg)(),(0,e.iD)("ul",{ul:"",class:"list-group",key:s.permisosID},[(0,e._)("li",B,(0,o.zw)(s.descripcion),1)])))),128))]))])])])])}var Y={name:"PermisosModal",props:{usuarioId:Number},data(){return{ListaPermisos:[],loading:!1,mensajeNoHayPermisos:!1}},created(){this.fetch()},methods:{async fetch(){this.loading=!0,await this.axios.get(`/api/Permisos/ObtenerPermisosUsuario/${this.usuarioId}`).then((s=>{this.ListaPermisos=s.data.usuario,this.ListaPermisos||(this.mensajeNoHayPermisos=!0)})).catch((s=>{console.log(s)})),this.loading=!1},cerrarModalPermisos(){console.log("Cerrando Modal pErmisos"),this.$emit("cerrar-modal-permisos")}}},F=r(89);const G=(0,F.Z)(Y,[["render",W],["__scopeId","data-v-6de39afd"]]);var K=G,O=r(9242);const R=s=>((0,e.dD)("data-v-33595604"),s=s(),(0,e.Cn)(),s),J={class:"modal"},Q={class:"modal-dialog"},X={class:"modal-content"},ss={class:"modal-header"},as=R((()=>(0,e._)("label",{class:"text-muted fs-7"},"Editar usuario 24",-1))),rs={class:"modal-body"},es={key:0,class:"d-flex justify-content-center"},os=R((()=>(0,e._)("div",{class:"spinner-border",role:"status"},[(0,e._)("span",{class:"sr-only"})],-1))),is=[os],ts={key:1},ls={class:"form-group"},ns=R((()=>(0,e._)("label",{for:"nombreUsuario"},"Usuario",-1))),cs={class:"form-group"},ds=R((()=>(0,e._)("label",{for:"clave"},"Contraseña",-1))),us=["id","value"],ms=["for"],hs={class:"form-check"},ps=["checked"],vs=R((()=>(0,e._)("label",{for:"todos",class:"form-check-label"},"Todos",-1))),gs={class:"modalFooter text-center"};function bs(s,a,r,i,t,l){return(0,e.wg)(),(0,e.iD)("div",J,[(0,e._)("div",Q,[(0,e._)("div",X,[(0,e._)("div",ss,[as,(0,e._)("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=(...s)=>l.cerrarModal&&l.cerrarModal(...s)),"aria-label":"Cerrar"})]),(0,e._)("div",rs,[t.loading?((0,e.wg)(),(0,e.iD)("div",es,is)):(0,e.kq)("",!0),t.loading?(0,e.kq)("",!0):((0,e.wg)(),(0,e.iD)("div",ts,[(0,e._)("form",{onSubmit:a[8]||(a[8]=(0,O.iM)((a=>s.updateUser()),["prevent"]))},[(0,e._)("div",null,[(0,e._)("div",ls,[ns,(0,e.wy)((0,e._)("input",{class:"form-control",id:"nombreUsuario",type:"text","onUpdate:modelValue":a[1]||(a[1]=s=>t.datosUsuariosCargados=s),placeholder:"Ingresar nombre de usuario",required:""},null,512),[[O.nr,t.datosUsuariosCargados]])]),(0,e._)("div",cs,[ds,(0,e.wy)((0,e._)("input",{class:"form-control",id:"clave",type:"password",placeholder:"Ingresar contraseña nueva","onUpdate:modelValue":a[2]||(a[2]=s=>t.clave=s)},null,512),[[O.nr,t.clave]])])]),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(t.permisos,((r,i)=>((0,e.wg)(),(0,e.iD)("div",{class:"form-check",key:i},[(0,e.wy)((0,e._)("input",{type:"checkbox",id:r,class:"form-check-input",value:i+1,"onUpdate:modelValue":a[3]||(a[3]=s=>t.permisosSeleccionados=s),onChange:a[4]||(a[4]=(...a)=>s.seleccionarTodosSiEsNecesario&&s.seleccionarTodosSiEsNecesario(...a))},null,40,us),[[O.e8,t.permisosSeleccionados]]),(0,e._)("label",{for:r,class:"form-check-label"},(0,o.zw)(r),9,ms)])))),128)),(0,e._)("div",hs,[(0,e._)("input",{type:"checkbox",id:"todos",class:"form-check-input",onChange:a[5]||(a[5]=(...a)=>s.marcarDesmarcarTodos&&s.marcarDesmarcarTodos(...a)),checked:l.todosSeleccionados},null,40,ps),vs]),(0,e._)("div",gs,[(0,e._)("button",{type:"button",class:"btn btn-outline-danger btn-sm m-1",onClick:a[6]||(a[6]=(...s)=>l.cerrarModal&&l.cerrarModal(...s))},"Cerrar"),(0,e._)("button",{type:"button",class:"btn btn-outline-success btn-sm m-1",onClick:a[7]||(a[7]=(...s)=>l.guardarEdicion&&l.guardarEdicion(...s))},"Guardar")])],32)]))])])])])}var ws=r(8867),fs={name:"EditarFilaModal",components:{AlertaSuceso:ws.Z},props:{usuarioId:Number},data(){return{loading:!1,permisos:["Crear usuarios","Editar usuarios","Ver usuarios","Editar permisos","Eliminar usuarios","Crear formularios","Ver formularios","Eliminar formularios","Responder formularios","Editar respuestas","Ver respuestas","Eliminar respuestas"],permisosSeleccionados:[],datosUsuariosCargados:{},NuevoNombreUsuario:"",clave:""}},computed:{todosSeleccionados(){return this.permisosSeleccionados.length===this.permisos.length}},created(){this.fetch()},methods:{async fetch(){this.loading=!0,alert(this.usuarioId),await this.axios.get(`/api/Permisos/ObtenerPermisosUsuario/${this.usuarioId}`).then((s=>{const a=s.data.usuario.map((s=>s.funcionId));this.permisosSeleccionados=a,console.log(this.permisosSeleccionados)})).catch((s=>{console.log(s)})),await this.axios.get(`/api/Usuarios/ObtenerUsuarioPorID/${this.usuarioId}`).then((s=>{this.datosUsuariosCargados=s.data.usuario.username})).catch((s=>{console.log(s)})),this.loading=!1},cerrarModal(){this.$emit("cerrar-modal-editar")},async guardarEdicion(){const s={userID:this.usuarioId,username:this.datosUsuariosCargados,roleID:0,permisos:this.permisosSeleccionados.map((s=>({permisoId:s})))};this.clave&&(s.password=this.clave);try{alert("  usuario:   "+this.usuarioId),console.log(s),await this.axios.put(`api/Usuarios/editarUsuario/${this.usuarioId}`,s),this.$emit("guardar-exito")}catch(a){console.error(a)}}}};const _s=(0,F.Z)(fs,[["render",bs],["__scopeId","data-v-33595604"]]);var ks=_s,ys=r(6653),xs=r(7006),Es=r(4271),Cs={name:"Formularios",components:{"barra-navegacion":ys.Z,"ver-permisos":K,"editar-usuario":ks,spinner:xs.Z,"alerta-suceso":ws.Z,"alerta-error":Es.Z},data:function(){return{MostrarSpinner:!1,ListaUsuarios:[],modalVerpermisos:!1,modalEditarUsuario:!1,idUsuario:null,mostrarAlertaEliminar:!1,mostrarAlertaSuceso:!1,mostrarAlertaError:!1,mensajeAlertaSuceso:"",mensajeAlertaError:"",idUserToDelete:null}},created(){this.fetch()},methods:{async fetch(){this.MostrarSpinner=!0,await this.axios.get("/api/Usuarios/ListaUsuarios").then((s=>{this.ListaUsuarios=s.data.lista,console.log(s.data.lista)})).catch((s=>{this.mensajeAlertaError="Error del servidor",this.mostrarAlertaError=!0,setTimeout((()=>{this.mostrarAlertaError=!1}),2e3)})),this.MostrarSpinner=!1},verPermisos(s){this.DatosUsuario=s,this.modalVerpermisos=!0},cerrarModalVerPermisos(){this.modalVerpermisos=!1},mostrarModalEdicion(s){this.DatosUsuario=s,this.modalEditarUsuario=!0},cerrarModalEdicion(){this.modalEditarUsuario=!1},editarListo(){this.modalEditarUsuario=!1,this.mensajeAlertaSuceso="Modificado exitosamente",this.mostrarAlertaSuceso=!0,this.fetch(),setTimeout((()=>{this.mostrarAlertaSuceso=!1}),2e3)},mostarAlertaConfirmacion(s){this.mostrarAlertaEliminar=!0,this.idUserToDelete=s.userID},cerrarAlertaConfirmacion(){this.mostrarAlertaEliminar=!1},async eliminarUsuario(){this.mostrarAlertaEliminar=!1,await this.axios.put(`/api/Usuarios/Eliminar/${this.idUserToDelete}`).then((s=>{this.mensajeAlertaSuceso="Eliminado exitosamente",this.mostrarAlertaSuceso=!0,this.fetch(),setTimeout((()=>{this.mostrarAlertaSuceso=!1}),2e3)})).catch((s=>{this.mensajeAlertaError="Error del servidor",this.mostrarAlertaError=!0,this.fetch(),setTimeout((()=>{this.mostrarAlertaError=!1}),2e3)}))}}};const Us=(0,F.Z)(Cs,[["render",S]]);var Ds=Us}}]);
//# sourceMappingURL=42.2de6890d.js.map